<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Estimate Emission Durations using Continuous Monitoring Sensors Systems • duration</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Estimate Emission Durations using Continuous Monitoring Sensors Systems">
<meta name="description" content="Estimate emission durations using Continuous Monitoring Sensors (CMS) systems, accounting for CMS non-detect times. The paper associated with this package is published here: &lt;https://doi.org/10.1021/acs.estlett.4c00687&gt;.">
<meta property="og:description" content="Estimate emission durations using Continuous Monitoring Sensors (CMS) systems, accounting for CMS non-detect times. The paper associated with this package is published here: &lt;https://doi.org/10.1021/acs.estlett.4c00687&gt;.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">duration</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Hammerling-Research-Group/duration/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="duration">duration<a class="anchor" aria-label="anchor" href="#duration"></a>
</h1></div>
<p><em>Production code for CMS Duration Estimation</em></p>
<p><a href="https://github.com/Hammerling-Research-Group/duration/actions/workflows/lint.yml" class="external-link"><img src="https://github.com/Hammerling-Research-Group/duration/actions/workflows/lint.yml/badge.svg" alt="CI lint"></a> <a href="https://github.com/Hammerling-Research-Group/duration/actions/workflows/cov.yml" class="external-link"><img src="https://github.com/Hammerling-Research-Group/duration/actions/workflows/cov.yml/badge.svg" alt="CI tests"></a> <a href="https://github.com/Hammerling-Research-Group/duration/actions/workflows/check-link-rot.yaml" class="external-link"><img src="https://github.com/Hammerling-Research-Group/duration/actions/workflows/check-link-rot.yaml/badge.svg" alt="Check Link Rot"></a> <a href="https://github.com/Hammerling-Research-Group/duration/blob/main/LICENSE" class="external-link"><img src="https://img.shields.io/github/license/Hammerling-Research-Group/duration?color=blue" alt="GitHub license"></a> <a href="https://github.com/Hammerling-Research-Group/duration/graphs/contributors/" class="external-link"><img src="https://img.shields.io/github/contributors/Hammerling-Research-Group/duration.svg" alt="GitHub contributors"></a></p>
<div class="section level2">
<h2 id="estimating-methane-emission-durations">Estimating Methane Emission Durations<a class="anchor" aria-label="anchor" href="#estimating-methane-emission-durations"></a>
</h2>
<p>This repository contains code used to estimate methane emission durations using concentration observations from a network of point-in-space continuous monitoring systems (CMS). The scripts include:</p>
<ul>
<li>
<code>estimate_durations.R</code>: main code for estimating durations</li>
<li>
<code>helpers.R</code>: suite of helper functions sourced internally in <code><a href="reference/estimate_durations.html">estimate_durations()</a></code>
</li>
</ul>
<p>The accompanying paper can be found here: <a href="https://doi.org/10.1021/acs.estlett.4c00687" class="external-link uri">https://doi.org/10.1021/acs.estlett.4c00687</a></p>
<p><em>Note: The code includes a shortened “toy” set of data from the 2023 ADED controlled release experiment. This is meant for demonstration purposes only to get users started with the code and to learn the required structure of input data.</em></p>
</div>
<div class="section level2">
<h2 id="installation--usage">Installation &amp; Usage<a class="anchor" aria-label="anchor" href="#installation--usage"></a>
</h2>
<p>Access the latest (dev) version:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#install.packages("devtools") # if needed on first usage</span></span>
<span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"Hammerling-Research-Group/duration"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Hammerling-Research-Group/duration" class="external-link">duration</a></span><span class="op">)</span></span></code></pre></div>
<p>Once installed and loaded, users should start with the core function, which produces duration estimates by emission source.</p>
<p>For example, run the following line to generate emission duration estimates, return a plot of the distributions of duration estimates by source using the supplied “toy” data, and store results on your Desktop (<em>note: full output is saved by default, the location of which is shared with the user</em>):</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/estimate_durations.html">estimate_durations</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="cn">TRUE</span>, directory <span class="op">=</span> <span class="st">"Desktop"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="some-notes-to-consider">Some Notes to Consider<a class="anchor" aria-label="anchor" href="#some-notes-to-consider"></a>
</h2>
<p>The default values are meant to allow for simple usage without the need for adjustment. Yet, given that toy data are used as input by default, at a minimum users should adjust the <code>data</code> by supplying real site data.</p>
<p>Available arguments for <code><a href="reference/estimate_durations.html">estimate_durations()</a></code> include:</p>
<ul>
<li>
<code>data</code>: Forward model output data stored as a list object. The format must match that of the sample input data in the <code>duration</code> package, or output data from other similar implementations, e.g., from <a href="https://github.com/wsdaniels/DLQ/" class="external-link"><code>MAIN_1_simulate.R</code></a> (<em>more details on data structure are in the following section</em>)</li>
<li>
<code>tz</code>: Time zone. Default set to <code>America/Denver</code>
</li>
<li>
<code>directory</code>: Location where results are saved. If not specified, a directory is created and the location is shared with the user</li>
<li>
<code>events</code>: Print the number of events per year for a quick check? Default set to <code>FALSE</code>
</li>
<li>
<code>plot</code>: Return a plot of the distribution of average duration estimates by source? Default set to <code>FALSE</code>
</li>
<li>
<code>time</code>: Return the timing of the simulation? Default set to <code>TRUE</code>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="input-data-structure">Input Data Structure<a class="anchor" aria-label="anchor" href="#input-data-structure"></a>
</h2>
<p>A key piece of working reliably with the <code>duration</code> package is the <em>structure of the input data</em>, which is very specific. To get a sense of what is required, users can read in and explore the provided sample data to learn about the structure, which must be contained in a list object. Each of the following basic options should be sufficient to allow users to structure their input data accordingly in order for the code to work as intended, and for the results to be reliable.</p>
<ol style="list-style-type: decimal">
<li>Read in the data:</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"input_data"</span>, package <span class="op">=</span> <span class="st">"duration"</span><span class="op">)</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html" class="external-link">read_rds</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Once read in, users can explore the data directly:</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/View.html" class="external-link">View</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Check out which objects are stored in the list for reference:</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">names</span>(data)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"times"</span>   <span class="st">"obs"</span>   <span class="st">"WD"</span>    <span class="st">"WS"</span>    <span class="st">"Tank"</span>    <span class="st">"Separator.East"</span>    <span class="st">"Wellhead.East"</span>   <span class="st">"Wellhead.West"</span>   <span class="st">"Separator.West"</span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Or, inspect the structure of the input data directly:</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">str</span>(data)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>List of <span class="dv">9</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a> <span class="sc">$</span> times         <span class="sc">:</span> POSIXct[<span class="dv">1</span><span class="sc">:</span><span class="dv">4001</span>], format<span class="sc">:</span> <span class="st">"2023-02-21 21:19:00"</span> <span class="st">"2023-02-21 21:20:00"</span> <span class="st">"2023-02-21 21:21:00"</span> <span class="st">"2023-02-21 21:22:00"</span> ...</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a> <span class="sc">$</span> obs           <span class="sc">:</span><span class="st">'data.frame'</span><span class="sc">:</span> <span class="dv">4001</span> obs. of  <span class="dv">10</span> variables<span class="sc">:</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  ..<span class="sc">$</span> ENE<span class="sc">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">4001</span>] <span class="fl">2.02</span> <span class="fl">2.04</span> <span class="fl">2.03</span> <span class="fl">2.06</span> <span class="fl">2.01</span> ...</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>  ..<span class="sc">$</span> ESE<span class="sc">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">4001</span>] <span class="fl">2.25</span> <span class="fl">2.25</span> <span class="cn">NA</span> <span class="fl">2.24</span> <span class="fl">2.24</span> ...</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a> <span class="sc">$</span> WD            <span class="sc">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">4001</span>] <span class="fl">1.98</span> <span class="fl">1.98</span> <span class="fl">2.02</span> <span class="fl">2.04</span> <span class="fl">1.93</span> ...</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a> <span class="sc">$</span> WS            <span class="sc">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">4001</span>] <span class="fl">3.41</span> <span class="fl">3.52</span> <span class="fl">3.25</span> <span class="fl">2.71</span> <span class="fl">2.72</span> <span class="fl">2.94</span> <span class="fl">3.08</span> <span class="fl">2.81</span> <span class="fl">3.16</span> <span class="fl">3.07</span> ...</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a> <span class="sc">$</span> Tank          <span class="sc">:</span><span class="st">'data.frame'</span><span class="sc">:</span> <span class="dv">4001</span> obs. of  <span class="dv">10</span> variables<span class="sc">:</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>  ..<span class="sc">$</span> ENE<span class="sc">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">4001</span>] <span class="fl">1.86e-49</span> <span class="fl">3.11e-49</span> <span class="fl">2.44e-49</span> <span class="fl">1.32e-50</span> <span class="fl">2.62e-85</span> ...</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>  ..<span class="sc">$</span> ESE<span class="sc">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">4001</span>] <span class="fl">1.81e-59</span> <span class="fl">2.50e-59</span> <span class="fl">2.12e-59</span> <span class="fl">1.61e-60</span> <span class="fl">9.60e-104</span> ...</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a> <span class="sc">$</span> Separator.East<span class="sc">:</span><span class="st">'data.frame'</span><span class="sc">:</span> <span class="dv">4001</span> obs. of  <span class="dv">10</span> variables<span class="sc">:</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>  ..<span class="sc">$</span> ENE<span class="sc">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">4001</span>] <span class="fl">6.41e-43</span> <span class="fl">8.05e-43</span> <span class="fl">6.14e-43</span> <span class="fl">2.61e-43</span> <span class="fl">1.04e-75</span> ...</span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>  ..<span class="sc">$</span> ESE<span class="sc">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">4001</span>] <span class="fl">1.35e-55</span> <span class="fl">1.42e-55</span> <span class="fl">1.87e-55</span> <span class="fl">1.77e-55</span> <span class="fl">6.67e-98</span> ...</span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a> <span class="sc">$</span> Wellhead.East <span class="sc">:</span><span class="st">'data.frame'</span><span class="sc">:</span> <span class="dv">4001</span> obs. of  <span class="dv">10</span> variables<span class="sc">:</span></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a>  ..<span class="sc">$</span> ENE<span class="sc">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">4001</span>] <span class="fl">4.00e-24</span> <span class="fl">5.48e-24</span> <span class="fl">1.71e-24</span> <span class="fl">9.56e-26</span> <span class="fl">1.83e-40</span> ...</span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a>  ..<span class="sc">$</span> ESE<span class="sc">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">4001</span>] <span class="fl">1.26e-37</span> <span class="fl">1.66e-37</span> <span class="fl">1.07e-37</span> <span class="fl">3.09e-38</span> <span class="fl">3.09e-66</span> ...</span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a> <span class="sc">$</span> Wellhead.West <span class="sc">:</span><span class="st">'data.frame'</span><span class="sc">:</span> <span class="dv">4001</span> obs. of  <span class="dv">10</span> variables<span class="sc">:</span></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a>  ..<span class="sc">$</span> ENE<span class="sc">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">4001</span>] <span class="fl">7.44e-90</span> <span class="fl">1.47e-89</span> <span class="fl">8.16e-90</span> <span class="fl">5.46e-91</span> <span class="fl">1.21e-151</span> ...</span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a>  ..<span class="sc">$</span> ESE<span class="sc">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">4001</span>] <span class="fl">1.95e-104</span> <span class="fl">3.68e-104</span> <span class="fl">2.18e-104</span> <span class="fl">3.86e-105</span> <span class="fl">1.78e-177</span> ...</span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a> <span class="sc">$</span> Separator.West<span class="sc">:</span><span class="st">'data.frame'</span><span class="sc">:</span> <span class="dv">4001</span> obs. of  <span class="dv">10</span> variables<span class="sc">:</span></span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a>  ..<span class="sc">$</span> ENE<span class="sc">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">4001</span>] <span class="fl">2.79e-60</span> <span class="fl">1.03e-59</span> <span class="fl">9.98e-60</span> <span class="fl">5.54e-62</span> <span class="fl">2.39e-101</span> ...</span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a>  ..<span class="sc">$</span> ESE<span class="sc">:</span> num [<span class="dv">1</span><span class="sc">:</span><span class="dv">4001</span>] <span class="fl">6.40e-69</span> <span class="fl">2.46e-68</span> <span class="fl">2.46e-68</span> <span class="fl">1.97e-70</span> <span class="fl">5.61e-117</span> ...</span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Specific information about each component of the input list is given below:</li>
</ol>
<ul>
<li>
<code>times</code>: Times of the CMS concentration data. Times must be at regular intervals, ideally every minute. Time information must be saved in a string format that can be read by the <code>as_datetime</code> function of the <code>lubridate</code> package, e.g., <code>"yyyy-mm-ddThh:mm:ss"</code>.</li>
<li>
<code>obs</code>: CMS concentration observations. The rows of the data frame correspond to the <code>times</code> of the observations and the columns correspond to the different CMS sensor locations.</li>
<li>
<code>WD</code>: Wind direction measurements in radians. The length of this vector must match the length of <code>times</code>.</li>
<li>
<code>WS</code>: Wind speed measurements in m/s. The length of this vector must match the length of <code>times</code>.</li>
<li>
<code>Tank</code>: Data frame containing simulated concentrations at the CMS sensor locations assuming that the tank is the emission source. The rows of the data frame correspond to the <code>times</code> of the simulated observations and the columns correspond to the different CMS sensor locations. A variable like <code>Tank</code> is required for all potential emission sources on the site.</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/Hammerling-Research-Group/duration/" class="external-link">Browse source code</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing duration</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>William Daniels <br><small class="roles"> Author </small>   </li>
<li>Philip Waggoner <br><small class="roles"> Author, maintainer </small>   </li>
<li>Dorit Hammerling <br><small class="roles"> Author, thesis advisor </small>   </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by William Daniels, Philip Waggoner, Dorit Hammerling.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
