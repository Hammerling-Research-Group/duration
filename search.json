[{"path":"https://hammerling-research-group.github.io/duration/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"William Daniels. Author. Philip Waggoner. Author, maintainer. Dorit Hammerling. Author, thesis advisor.","code":""},{"path":"https://hammerling-research-group.github.io/duration/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Daniels W, Waggoner P, Hammerling D (2025). duration: Estimate Emission Durations using Continuous Monitoring Sensors Systems. R package version 0.1.0, https://hammerling-research-group.github.io/duration/, https://github.com/Hammerling-Research-Group/duration.","code":"@Manual{,   title = {duration: Estimate Emission Durations using Continuous Monitoring Sensors Systems},   author = {William Daniels and Philip Waggoner and Dorit Hammerling},   year = {2025},   note = {R package version 0.1.0, https://hammerling-research-group.github.io/duration/},   url = {https://github.com/Hammerling-Research-Group/duration}, }"},{"path":"https://hammerling-research-group.github.io/duration/index.html","id":"duration","dir":"","previous_headings":"","what":"Estimate Emission Durations using Continuous Monitoring Sensors Systems","title":"Estimate Emission Durations using Continuous Monitoring Sensors Systems","text":"Production code CMS Duration Estimation","code":""},{"path":"https://hammerling-research-group.github.io/duration/index.html","id":"estimating-methane-emission-durations","dir":"","previous_headings":"","what":"Estimating Methane Emission Durations","title":"Estimate Emission Durations using Continuous Monitoring Sensors Systems","text":"repository contains code used estimate methane emission durations using concentration observations network point--space continuous monitoring systems (CMS). scripts include: estimate_durations.R: main code estimating durations helpers.R: suite helper functions sourced internally estimate_durations() accompanying paper can found : https://doi.org/10.1021/acs.estlett.4c00687 Note: code includes shortened “toy” set data 2023 ADED controlled release experiment. meant demonstration purposes get users started code learn required structure input data.","code":""},{"path":"https://hammerling-research-group.github.io/duration/index.html","id":"installation--usage","dir":"","previous_headings":"","what":"Installation & Usage","title":"Estimate Emission Durations using Continuous Monitoring Sensors Systems","text":"Access latest (dev) version: installed loaded, users start core function, produces duration estimates emission source. example, run following line generate emission duration estimates, return plot distributions duration estimates source using supplied “toy” data, store results Desktop (note: full output saved default, location shared user):","code":"#install.packages(\"devtools\") # if needed on first usage  devtools::install_github(\"Hammerling-Research-Group/duration\")  library(duration) estimate_durations(plot = TRUE, directory = \"Desktop\")"},{"path":"https://hammerling-research-group.github.io/duration/index.html","id":"some-notes-to-consider","dir":"","previous_headings":"","what":"Some Notes to Consider","title":"Estimate Emission Durations using Continuous Monitoring Sensors Systems","text":"default values meant allow simple usage without need adjustment. Yet, given toy data used input default, minimum users adjust data supplying real site data. Available arguments estimate_durations() include: data: Forward model output data stored list object. format must match sample input data duration package, output data similar implementations, e.g., MAIN_1_simulate.R (details data structure following section) tz: Time zone. Default set America/Denver directory: Location results saved. specified, directory created location shared user events: Print number events per year quick check? Default set FALSE plot: Return plot distribution average duration estimates source? Default set FALSE time: Return timing simulation? Default set TRUE","code":""},{"path":"https://hammerling-research-group.github.io/duration/index.html","id":"input-data-structure","dir":"","previous_headings":"","what":"Input Data Structure","title":"Estimate Emission Durations using Continuous Monitoring Sensors Systems","text":"key piece working reliably duration package structure input data, specific. get sense required, users can read explore provided sample data learn structure, must contained list object. following basic options sufficient allow users structure input data accordingly order code work intended, results reliable. Read data: read , users can explore data directly: Check objects stored list reference: , inspect structure input data directly: Specific information component input list given : times: Times CMS concentration data. Times must regular intervals, ideally every minute. Time information must saved string format can read as_datetime function lubridate package, e.g., \"yyyy-mm-ddThh:mm:ss\". obs: CMS concentration observations. rows data frame correspond times observations columns correspond different CMS sensor locations. WD: Wind direction measurements radians. length vector must match length times. WS: Wind speed measurements m/s. length vector must match length times. Tank: Data frame containing simulated concentrations CMS sensor locations assuming tank emission source. rows data frame correspond times simulated observations columns correspond different CMS sensor locations. variable like Tank required potential emission sources site.","code":"df <- list.files(system.file(\"input_data\", package = \"duration\"), full.names = TRUE) data <- readr::read_rds(df[1]) View(data) > names(data)  [1] \"times\"   \"obs\"   \"WD\"    \"WS\"    \"Tank\"    \"Separator.East\"    \"Wellhead.East\"   \"Wellhead.West\"   \"Separator.West\" > str(data)  List of 9  $ times         : POSIXct[1:4001], format: \"2023-02-21 21:19:00\" \"2023-02-21 21:20:00\" \"2023-02-21 21:21:00\" \"2023-02-21 21:22:00\" ...  $ obs           :'data.frame': 4001 obs. of  10 variables:   ..$ ENE: num [1:4001] 2.02 2.04 2.03 2.06 2.01 ...   ..$ ESE: num [1:4001] 2.25 2.25 NA 2.24 2.24 ...  $ WD            : num [1:4001] 1.98 1.98 2.02 2.04 1.93 ...  $ WS            : num [1:4001] 3.41 3.52 3.25 2.71 2.72 2.94 3.08 2.81 3.16 3.07 ...  $ Tank          :'data.frame': 4001 obs. of  10 variables:   ..$ ENE: num [1:4001] 1.86e-49 3.11e-49 2.44e-49 1.32e-50 2.62e-85 ...   ..$ ESE: num [1:4001] 1.81e-59 2.50e-59 2.12e-59 1.61e-60 9.60e-104 ...  $ Separator.East:'data.frame': 4001 obs. of  10 variables:   ..$ ENE: num [1:4001] 6.41e-43 8.05e-43 6.14e-43 2.61e-43 1.04e-75 ...   ..$ ESE: num [1:4001] 1.35e-55 1.42e-55 1.87e-55 1.77e-55 6.67e-98 ...  $ Wellhead.East :'data.frame': 4001 obs. of  10 variables:   ..$ ENE: num [1:4001] 4.00e-24 5.48e-24 1.71e-24 9.56e-26 1.83e-40 ...   ..$ ESE: num [1:4001] 1.26e-37 1.66e-37 1.07e-37 3.09e-38 3.09e-66 ...  $ Wellhead.West :'data.frame': 4001 obs. of  10 variables:   ..$ ENE: num [1:4001] 7.44e-90 1.47e-89 8.16e-90 5.46e-91 1.21e-151 ...   ..$ ESE: num [1:4001] 1.95e-104 3.68e-104 2.18e-104 3.86e-105 1.78e-177 ...  $ Separator.West:'data.frame': 4001 obs. of  10 variables:   ..$ ENE: num [1:4001] 2.79e-60 1.03e-59 9.98e-60 5.54e-62 2.39e-101 ...   ..$ ESE: num [1:4001] 6.40e-69 2.46e-68 2.46e-68 1.97e-70 5.61e-117 ..."},{"path":"https://hammerling-research-group.github.io/duration/reference/create.info.mask.html","id":null,"dir":"Reference","previous_headings":"","what":"Determine which time periods have information from the CMS sensors and which do not — create.info.mask","title":"Determine which time periods have information from the CMS sensors and which do not — create.info.mask","text":"Determine time periods information CMS sensors ","code":""},{"path":"https://hammerling-research-group.github.io/duration/reference/create.info.mask.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Determine which time periods have information from the CMS sensors and which do not — create.info.mask","text":"","code":"create.info.mask(times, sims, gap.time = 0, length.threshold = 15)"},{"path":"https://hammerling-research-group.github.io/duration/reference/estimate_durations.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate emission durations using continuous monitoring systems (CMS), accounting for CMS non-detect times — estimate_durations","title":"Estimate emission durations using continuous monitoring systems (CMS), accounting for CMS non-detect times — estimate_durations","text":"Estimate emission durations using continuous monitoring systems (CMS), accounting CMS non-detect times","code":""},{"path":"https://hammerling-research-group.github.io/duration/reference/estimate_durations.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate emission durations using continuous monitoring systems (CMS), accounting for CMS non-detect times — estimate_durations","text":"","code":"estimate_durations(data, tz, directory, events, plot, time)"},{"path":"https://hammerling-research-group.github.io/duration/reference/estimate_durations.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate emission durations using continuous monitoring systems (CMS), accounting for CMS non-detect times — estimate_durations","text":"data List. Forward model output data. format must match sample (default) shortened data 2023 ADED controlled release experiment, released duration package. tz Character. Time zone. Default set America/Denver. directory Character. Location results output saved. specified, directory created location shared user. events Logical. Print number events per year? Default set FALSE. plot Logical. Return plot distribution average duration estimates source? Default set FALSE. time Logical. Return timing simulation. Default set TRUE.","code":""},{"path":"https://hammerling-research-group.github.io/duration/reference/estimate_durations.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate emission durations using continuous monitoring systems (CMS), accounting for CMS non-detect times — estimate_durations","text":"Listed output estimated durations emission source. Saved newly created directory (Results Output).","code":""},{"path":"https://hammerling-research-group.github.io/duration/reference/estimate_durations.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Estimate emission durations using continuous monitoring systems (CMS), accounting for CMS non-detect times — estimate_durations","text":"William Daniels, Philip Waggoner, Dorit Hammerling","code":""},{"path":"https://hammerling-research-group.github.io/duration/reference/estimate_durations.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate emission durations using continuous monitoring systems (CMS), accounting for CMS non-detect times — estimate_durations","text":"","code":"estimate_durations(directory = \"Desktop\", plot = TRUE) #>  #> ── Reading & cleaning data ───────────────────────────────────────────────────── #> ✔ Complete #>  #> ── Identifying naive events & creating localization + quantification estimates f #> Performing quantification ■■■                                7% | Step: 1/14 | … #> Performing quantification ■■■■■■■                           21% | Step: 3/14 | … #> Performing quantification ■■■■■■■■■■                        29% | Step: 4/14 | … #> Performing quantification ■■■■■■■■■■■■                      36% | Step: 5/14 | … #> Performing quantification ■■■■■■■■■■■■■■                    43% | Step: 6/14 | … #> Performing quantification ■■■■■■■■■■■■■■■■                  50% | Step: 7/14 | … #> Performing quantification ■■■■■■■■■■■■■■■■■■                57% | Step: 8/14 | … #> Performing quantification ■■■■■■■■■■■■■■■■■■■■■■            71% | Step: 10/14 |… #> Performing quantification ■■■■■■■■■■■■■■■■■■■■■■■■■         79% | Step: 11/14 |… #> Performing quantification ■■■■■■■■■■■■■■■■■■■■■■■■■■■       86% | Step: 12/14 |… #> Performing quantification ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■     93% | Step: 13/14 |… #> Performing quantification ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■  100% | Step: 14/14 |… #> ✔ Complete #>  #> ── Estimating durations ──────────────────────────────────────────────────────── #> ✔ Complete #>  #> ── Estimating frequencies ────────────────────────────────────────────────────── #> ✔ Complete #>  #> ── Writing out results to working directory ──────────────────────────────────── #> ✔ Complete #>  #> ── Timing ────────────────────────────────────────────────────────────────────── #> ℹ The process took 1m 41s to run #> → Results saved at: /home/runner/Desktop/Results Output/duration_estimates.rds"},{"path":"https://hammerling-research-group.github.io/duration/reference/find.spikes.html","id":null,"dir":"Reference","previous_headings":"","what":"Find spikes from DLQ code — find.spikes","title":"Find spikes from DLQ code — find.spikes","text":"Find spikes DLQ code","code":""},{"path":"https://hammerling-research-group.github.io/duration/reference/find.spikes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find spikes from DLQ code — find.spikes","text":"","code":"find.spikes(   times,   obs,   going.up.threshold = 0.25,   return.threshold = 5,   amp.threshold = 1,   cont.diff.threshold = 0.25,   cont.diff.num = 10 )"},{"path":"https://hammerling-research-group.github.io/duration/reference/get.combine.info.html","id":null,"dir":"Reference","previous_headings":"","what":"Determine which naive events have non-zero probability of being combined with their neighbors — get.combine.info","title":"Determine which naive events have non-zero probability of being combined with their neighbors — get.combine.info","text":"Determine naive events non-zero probability combined neighbors","code":""},{"path":"https://hammerling-research-group.github.io/duration/reference/get.combine.info.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Determine which naive events have non-zero probability of being combined with their neighbors — get.combine.info","text":"","code":"get.combine.info(spikes, info.list, loc.est.all.events, tz)"},{"path":"https://hammerling-research-group.github.io/duration/reference/get.durations.html","id":null,"dir":"Reference","previous_headings":"","what":"Get distribution of possible durations for a given naive event — get.durations","title":"Get distribution of possible durations for a given naive event — get.durations","text":"Get distribution possible durations given naive event","code":""},{"path":"https://hammerling-research-group.github.io/duration/reference/get.durations.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get distribution of possible durations for a given naive event — get.durations","text":"","code":"get.durations(spikes, info.list, loc.est.all.events, rate.est.all.events, tz)"},{"path":"https://hammerling-research-group.github.io/duration/reference/get.event.counts.html","id":null,"dir":"Reference","previous_headings":"","what":"Get number of events by source, accounting for possibility to recombine events — get.event.counts","title":"Get number of events by source, accounting for possibility to recombine events — get.event.counts","text":"Get number events source, accounting possibility recombine events","code":""},{"path":"https://hammerling-research-group.github.io/duration/reference/get.event.counts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get number of events by source, accounting for possibility to recombine events — get.event.counts","text":"","code":"get.event.counts(   spikes,   info.list,   loc.est.all.events,   rate.est.all.events,   tz )"},{"path":"https://hammerling-research-group.github.io/duration/reference/get.sensor.arrangement.html","id":null,"dir":"Reference","previous_headings":"","what":"Get sensor arrangement — get.sensor.arrangement","title":"Get sensor arrangement — get.sensor.arrangement","text":"Get sensor arrangement","code":""},{"path":"https://hammerling-research-group.github.io/duration/reference/get.sensor.arrangement.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get sensor arrangement — get.sensor.arrangement","text":"","code":"get.sensor.arrangement(run.type, which.arrangement, data, z)"},{"path":"https://hammerling-research-group.github.io/duration/reference/lseq.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a logarithmic spaced sequence — lseq","title":"Create a logarithmic spaced sequence — lseq","text":"Create logarithmic spaced sequence","code":""},{"path":"https://hammerling-research-group.github.io/duration/reference/lseq.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a logarithmic spaced sequence — lseq","text":"","code":"lseq(from, to, length.out)"},{"path":"https://hammerling-research-group.github.io/duration/reference/perform.event.detection.alt.html","id":null,"dir":"Reference","previous_headings":"","what":"Create naive emission durations that do not account for CMS non-detect times (Alt version for direct handling of first obs for testing with toy data) — perform.event.detection.alt","title":"Create naive emission durations that do not account for CMS non-detect times (Alt version for direct handling of first obs for testing with toy data) — perform.event.detection.alt","text":"Create naive emission durations account CMS non-detect times (Alt version direct handling first obs testing toy data)","code":""},{"path":"https://hammerling-research-group.github.io/duration/reference/perform.event.detection.alt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create naive emission durations that do not account for CMS non-detect times (Alt version for direct handling of first obs for testing with toy data) — perform.event.detection.alt","text":"","code":"perform.event.detection.alt(times, max.obs, gap.time, length.threshold)"},{"path":"https://hammerling-research-group.github.io/duration/reference/perform.event.detection.html","id":null,"dir":"Reference","previous_headings":"","what":"Create naive emission durations that do not account for CMS non-detect times — perform.event.detection","title":"Create naive emission durations that do not account for CMS non-detect times — perform.event.detection","text":"Create naive emission durations account CMS non-detect times","code":""},{"path":"https://hammerling-research-group.github.io/duration/reference/perform.event.detection.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create naive emission durations that do not account for CMS non-detect times — perform.event.detection","text":"","code":"perform.event.detection(times, max.obs, gap.time, length.threshold)"},{"path":"https://hammerling-research-group.github.io/duration/reference/perform.localization.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate emission source for each naive event — perform.localization","title":"Estimate emission source for each naive event — perform.localization","text":"Estimate emission source naive event","code":""},{"path":"https://hammerling-research-group.github.io/duration/reference/perform.localization.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate emission source for each naive event — perform.localization","text":"","code":"perform.localization(spikes, obs, sims)"},{"path":"https://hammerling-research-group.github.io/duration/reference/perform.quantification.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate emission rate for each naive event — perform.quantification","title":"Estimate emission rate for each naive event — perform.quantification","text":"Estimate emission rate naive event","code":""},{"path":"https://hammerling-research-group.github.io/duration/reference/perform.quantification.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate emission rate for each naive event — perform.quantification","text":"","code":"perform.quantification(times, spikes, obs, sims, loc.est.all.events)"},{"path":"https://hammerling-research-group.github.io/duration/reference/plot_durations.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot distributions of avg durations by source — plot_durations","title":"Plot distributions of avg durations by source — plot_durations","text":"Plot distributions avg durations source","code":""},{"path":"https://hammerling-research-group.github.io/duration/reference/plot_durations.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot distributions of avg durations by source — plot_durations","text":"","code":"plot_durations(durations_list, type = c(\"histogram\", \"density\"))"},{"path":"https://hammerling-research-group.github.io/duration/reference/remove.background.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove background from concentration time series — remove.background","title":"Remove background from concentration time series — remove.background","text":"Remove background concentration time series","code":""},{"path":"https://hammerling-research-group.github.io/duration/reference/remove.background.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove background from concentration time series — remove.background","text":"","code":"remove.background(times, obs, going.up.threshold, amp.threshold, gap.time)"},{"path":"https://hammerling-research-group.github.io/duration/reference/scale.sims.html","id":null,"dir":"Reference","previous_headings":"","what":"Scale simulated concentrations by the estimated emission rate of the nearest naive event — scale.sims","title":"Scale simulated concentrations by the estimated emission rate of the nearest naive event — scale.sims","text":"Scale simulated concentrations estimated emission rate nearest naive event","code":""},{"path":"https://hammerling-research-group.github.io/duration/reference/scale.sims.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Scale simulated concentrations by the estimated emission rate of the nearest naive event — scale.sims","text":"","code":"# S3 method for class 'sims' scale(times, sims, spikes, loc.est.all.events, rate.est.all.events)"},{"path":"https://hammerling-research-group.github.io/duration/reference/using_packages.html","id":null,"dir":"Reference","previous_headings":"","what":"Quietly checks, installs, then loads libraries needed to run the simulation — using_packages","title":"Quietly checks, installs, then loads libraries needed to run the simulation — using_packages","text":"Quietly checks, installs, loads libraries needed run simulation","code":""},{"path":"https://hammerling-research-group.github.io/duration/reference/using_packages.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Quietly checks, installs, then loads libraries needed to run the simulation — using_packages","text":"","code":"using_packages(...)"}]
